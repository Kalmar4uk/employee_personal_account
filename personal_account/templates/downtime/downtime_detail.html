{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="downtime-detail-container">
    <div class="section-btn-back">
        {% if "from_history" not in request.GET %}
            <a href="{% url 'downtimes:downtime' %}" class="back-chevron-btn">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#2c3e50" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </a>
        {% else %}
            <a href="{% url 'downtimes:history_downtime' %}" class="back-chevron-btn">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#2c3e50" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </a>
        {% endif %}
        </a>
    </div>
    <div class="downtime-detail-card">
        <div class="downtime-detail-header">
            <div class="downtime-detail-info">
                <h1 class="downtime-detail-title">
                    <div class="downtime-detail-service">{{ downtime.service }}</div>
                    <div class="downtime-detail-meta">
                        ID: #{{ downtime.id }} • Добавил: {{ downtime.author }} • Создано: {{ downtime.created_at|date:"d.m.Y H:i" }}
                    </div>
                </h1>
            </div>
        </div>

        <div class="downtime-info-grid">
            <div class="info-group">
                <span class="info-label">Сервис</span>
                <span class="info-value">{{ downtime.service }}</span>
            </div>

            <div class="info-group">
                <span class="info-label">Сотрудник ГСМАиЦП</span>
                <span class="info-value">
                    {{ downtime.gsma_employee.get_full_name|default:downtime.gsma_employee.username }}
                </span>
            </div>
            
            <div class="info-group">
                <span class="info-label">Начало работ</span>
                <span class="info-value">{{ downtime.start_downtime|date:"d.m.Y H:i" }}</span>
            </div>
            
            <div class="info-group">
                <span class="info-label">Окончание работ</span>
                <span class="info-value">{{ downtime.end_downtime|date:"d.m.Y H:i" }}</span>
            </div>

        </div>

        <div class="link-block">
            <div class="link-label">Ссылка на задачу</div>
            <div class="link-content"><a href="{{ downtime.link_task }}">{{ downtime.link_task }}</a></div>
        </div>

        <div class="description-block">
            <div class="description-label">Описание работ</div>
            <div class="description-content">
                {{ downtime.description|linebreaks }}
            </div>
        </div>

        <div class="meta-card">
            <div class="meta-grid">
                <div class="meta-item">
                    <span class="meta-label">Дата создания записи</span>
                    <span class="meta-value">{{ downtime.created_at|date:"d.m.Y H:i" }}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">ID записи</span>
                    <span class="meta-value">#{{ downtime.id }}</span>
                </div>
            </div>
        </div>
    <div class="btn-block">
        {% if "from_history" not in request.GET %}
            <a href="{% url 'downtimes:edit_downtime' downtime.id %}" class="detail-btn edit-btn">Редактировать</a>
            <a href="{% url 'downtimes:edit_reminder' downtime.id reminder_downtime %}" class="detail-btn edit-btn">Изменить время напоминания</a>
        {% endif %}
    </div>
    </div>
</div>
{% endblock %}