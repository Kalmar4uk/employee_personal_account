{% extends "base.html" %}
{% load static %}
{% block content %}
    <div class="section">
        <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
        <div class="info-blocks">
            <div class="info-block">
                <h3>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <p><strong>–§–ò–û:</strong> {{ employee.last_name }} {{ employee.first_name }}</p>
                <p><strong>–î–æ–ª–∂–Ω–æ—Å—Ç—å:</strong> {{ employee.job_title }}</p>
                <p><strong>–û—Ç–¥–µ–ª:</strong>
                    <a href="{% url 'users:groups_detail' group.id %}" class="group-pill">
                    <span class="group-icon">üë•</span>
                        {{ group.title }}
                    <span class="group-arrow">‚Üí</span>
                    </a>
                </p>
            </div>
            
            <div class="info-block">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <p><strong>Email:</strong> {{ employee.email }}</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ –∞–≤–≥—É—Å—Ç 2025</h2>
        <div class="calendar">
            
            <div class="weekdays">
                <div class="weekday">–ü–Ω</div>
                <div class="weekday">–í—Ç</div>
                <div class="weekday">–°—Ä</div>
                <div class="weekday">–ß—Ç</div>
                <div class="weekday">–ü—Ç</div>
                <div class="weekday">–°–±</div>
                <div class="weekday">–í—Å</div>
            </div>
            
            <div class="days-grid" id="calendar-days">
            </div>
            
            <div class="calendar-legend">
                <div class="legend-item legend-day-off">
                    <div class="legend-color"></div>
                    <span>–í—ã—Ö–æ–¥–Ω–æ–π</span>
                </div>
                <div class="legend-item legend-day-shift">
                    <div class="legend-color"></div>
                    <span>–î–Ω–µ–≤–Ω–∞—è —Å–º–µ–Ω–∞ (9:00-18:00)</span>
                </div>
                <div class="legend-item legend-night-shift">
                    <div class="legend-color"></div>
                    <span>–ù–æ—á–Ω–∞—è —Å–º–µ–Ω–∞ (22:00-6:00)</span>
                </div>
                <div class="legend-item legend-vacation">
                    <div class="legend-color"></div>
                    <span>–û—Ç–ø—É—Å–∫</span>
                </div>
                <div class="legend-item legend-sick">
                    <div class="legend-color"></div>
                    <span>–ë–æ–ª—å–Ω–∏—á–Ω—ã–π</span>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>–û—Ç–ø—É—Å–∫–∞</h2>
        <table class="schedule-table">
            <thead>
                <tr>
                    <th>–ü–µ—Ä–∏–æ–¥</th>
                    <th>–¢–∏–ø –æ—Ç–ø—É—Å–∫–∞</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–Ω–µ–π</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>01.07.2023 - 15.07.2023</td>
                    <td>–ï–∂–µ–≥–æ–¥–Ω—ã–π –æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–π</td>
                    <td><span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω</span></td>
                    <td>15</td>
                </tr>
                <tr>
                    <td>01.02.2024 - 14.02.2024</td>
                    <td>–ï–∂–µ–≥–æ–¥–Ω—ã–π –æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–π</td>
                    <td><span class="status-badge status-planned">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</span></td>
                    <td>14</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    const scheduleData = JSON.parse('{{ calendar|escapejs }}');

    function generateCalendar(year, month) {
        const calendarDays = document.getElementById('calendar-days');
        calendarDays.innerHTML = '';
        
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const firstDayOfWeek = firstDay.getDay() === 0 ? 7 : firstDay.getDay();
        
        for (let i = 1; i < firstDayOfWeek; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'day day-empty';
            calendarDays.appendChild(emptyDay);
        }
        
        for (let day = 1; day <= lastDay.getDate(); day++) {
            const date = new Date(year, month, day);
            const dateString = formatDate(date);
            const dayData = scheduleData[dateString] || { type: 'day-off', time: '–í—ã—Ö–æ–¥–Ω–æ–π' };
            const dayElement = document.createElement('div');
            dayElement.className = `day ${dayData.type}`;
            
            const today = new Date();
            if (date.toDateString() === today.toDateString()) {
                dayElement.classList.add('current-day');
            }
            
            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            
            const dayContent = document.createElement('div');
            dayContent.className = 'day-content';
            dayContent.textContent = dayData.time;
            
            dayElement.appendChild(dayNumber);
            dayElement.appendChild(dayContent);
            
            calendarDays.appendChild(dayElement);
        }
    }
    
    function formatDate(date) {
        const year = date.getFullYear();
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const day = date.getDate().toString().padStart(2, '0');
        return `${year}-${month}-${day}`;
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        generateCalendar(2025, 8);
    });
</script>
{% endblock %}